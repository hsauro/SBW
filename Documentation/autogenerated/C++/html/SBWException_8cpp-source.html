<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SBWException.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>SBWException.cpp</h1><a href="SBWException_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00013 <font class="comment">/*</font>
00014 <font class="comment">** Copyright 2001 California Institute of Technology and</font>
00015 <font class="comment">** Japan Science and Technology Corporation.</font>
00016 <font class="comment">** </font>
00017 <font class="comment">** This library is free software; you can redistribute it and/or modify it</font>
00018 <font class="comment">** under the terms of the GNU Lesser General Public License as published</font>
00019 <font class="comment">** by the Free Software Foundation; either version 2.1 of the License, or</font>
00020 <font class="comment">** any later version.</font>
00021 <font class="comment">** </font>
00022 <font class="comment">** This library is distributed in the hope that it will be useful, but</font>
00023 <font class="comment">** WITHOUT ANY WARRANTY, WITHOUT EVEN THE IMPLIED WARRANTY OF</font>
00024 <font class="comment">** MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  The software and</font>
00025 <font class="comment">** documentation provided hereunder is on an "as is" basis, and the</font>
00026 <font class="comment">** California Institute of Technology and Japan Science and Technology</font>
00027 <font class="comment">** Corporation have no obligations to provide maintenance, support,</font>
00028 <font class="comment">** updates, enhancements or modifications.  In no event shall the</font>
00029 <font class="comment">** California Institute of Technology or the Japan Science and Technology</font>
00030 <font class="comment">** Corporation be liable to any party for direct, indirect, special,</font>
00031 <font class="comment">** incidental or consequential damages, including lost profits, arising</font>
00032 <font class="comment">** out of the use of this software and its documentation, even if the</font>
00033 <font class="comment">** California Institute of Technology and/or Japan Science and Technology</font>
00034 <font class="comment">** Corporation have been advised of the possibility of such damage.  See</font>
00035 <font class="comment">** the GNU Lesser General Public License for more details.</font>
00036 <font class="comment">** </font>
00037 <font class="comment">** You should have received a copy of the GNU Lesser General Public License</font>
00038 <font class="comment">** along with this library; if not, write to the Free Software Foundation,</font>
00039 <font class="comment">** Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.</font>
00040 <font class="comment">**</font>
00041 <font class="comment">** The original code contained here was initially developed by:</font>
00042 <font class="comment">**</font>
00043 <font class="comment">**     Andrew Finney, Herbert Sauro, Michael Hucka, Hamid Bolouri</font>
00044 <font class="comment">**     The Systems Biology Workbench Development Group</font>
00045 <font class="comment">**     ERATO Kitano Systems Biology Project</font>
00046 <font class="comment">**     Control and Dynamical Systems, MC 107-81</font>
00047 <font class="comment">**     California Institute of Technology</font>
00048 <font class="comment">**     Pasadena, CA, 91125, USA</font>
00049 <font class="comment">**</font>
00050 <font class="comment">**     http://www.cds.caltech.edu/erato</font>
00051 <font class="comment">**     mailto:sysbio-team@caltech.edu</font>
00052 <font class="comment">**</font>
00053 <font class="comment">** Contributor(s):</font>
00054 <font class="comment">**</font>
00055 <font class="comment">*/</font>
00056 
00057 <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">char</font> rcsid[] = <font class="stringliteral">"$Id: SBWException_8cpp-source.html,v 1.1 2002/11/22 08:14:48 mhucka Exp $"</font>;
00058 
00059 <font class="comment">// SBWException.cpp: implementation of the SBWException class.</font>
00060 <font class="comment">//</font>
00062 <font class="comment"></font>
00063 <font class="preprocessor">#include "<a class="code" href="stdafx_8h.html">stdafx.h</a>"</font>
00064 <font class="preprocessor">#include "<a class="code" href="sbwplusbasictypes_8h.html">sbwplusbasictypes.h</a>"</font>
00065 <font class="preprocessor">#include "<a class="code" href="SBWException_8h.html">SBWException.h</a>"</font>
00066 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00067 
00068 <font class="keyword">using</font> <font class="keyword">namespace </font>SystemsBiologyWorkbench ;
00069 
00071 <font class="comment">// Construction/Destruction</font>
00073 <font class="comment"></font>
00077 <font class="comment"></font>std::map&lt;int, SBWException *&gt; SBWException::exceptionMap ;
00078 
00082 SBWOSMutex SBWException::threadStoreMutex(<font class="stringliteral">"exception store"</font>) ;
00083 
<a name="l00088"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a0">00088</a> SBWException::SBWException(<font class="keyword">const</font> <font class="keywordtype">char</font> *c) : m_szMessage(strdup(c)), m_szDetailedMessage(NULL)
00089 {
00090 }
00091 
<a name="l00097"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a1">00097</a> SBWException::SBWException(<font class="keyword">const</font> <font class="keywordtype">char</font> *c, <font class="keyword">const</font> <font class="keywordtype">char</font> *d)
00098 : m_szMessage(strdup(c)), m_szDetailedMessage(strdup(d))
00099 {
00100 }
00101 
<a name="l00106"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a2">00106</a> SBWException::SBWException(std::string sc) : m_szMessage(strdup(sc.c_str())), m_szDetailedMessage(NULL)
00107 {
00108 }
00109 
00110 
<a name="l00116"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a3">00116</a> SBWException::SBWException(std::string sc, std::string sd)
00117 : m_szMessage(strdup(sc.c_str())), m_szDetailedMessage(strdup(sd.c_str()))
00118 {
00119 }
00120 
<a name="l00124"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a4">00124</a> SBWException::~SBWException()
00125 {
00126         free((<font class="keywordtype">void</font> *)m_szMessage);
00127 
00128         <font class="keywordflow">if</font> (m_szDetailedMessage != NULL)
00129                 free((<font class="keywordtype">void</font> *)m_szDetailedMessage);
00130 }
00131 
<a name="l00135"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a7">00135</a> <font class="keywordtype">void</font> SBWException::log()
00136 {
00137         printf(m_szMessage);
00138         printf(<font class="stringliteral">"\n"</font>);
00139 
00140         <font class="keywordflow">if</font> (m_szDetailedMessage != NULL)
00141         {
00142                 printf(m_szDetailedMessage);
00143                 printf(<font class="stringliteral">"\n"</font>);
00144         }
00145 }
00146 
<a name="l00151"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#d0">00151</a> <font class="keywordtype">void</font> SBWException::log(<font class="keyword">const</font> <font class="keywordtype">char</font> *c)
00152 {
00153         printf(c);
00154         printf(<font class="stringliteral">"\n"</font>);
00155 }
00156 
<a name="l00162"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#d1">00162</a> <font class="keywordtype">void</font> SBWException::log(<font class="keyword">const</font> <font class="keywordtype">char</font> *c, <font class="keyword">const</font> <font class="keywordtype">char</font> *d)
00163 {
00164         printf(c);\
00165         printf(<font class="stringliteral">"\n"</font>);
00166         printf(d);
00167         printf(<font class="stringliteral">"\n"</font>);
00168 }
00169 
<a name="l00174"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a9">00174</a> <font class="keywordtype">void</font> *SBWException::operator new(size_t size)
00175 {
00176         <font class="keywordflow">return</font> malloc(size);
00177 }
00178 
<a name="l00183"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a10">00183</a> <font class="keywordtype">void</font> SBWException::operator delete(<font class="keywordtype">void</font> *x)
00184 {
00185         free(x);
00186 }
00187 
<a name="l00192"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#d4">00192</a> SBWException *SBWException::getStoredException()
00193 {
00194 <font class="preprocessor">#ifdef WIN32</font>
00195 <font class="preprocessor"></font>        DWORD threadId = GetCurrentThreadId();
00196 <font class="preprocessor">#elif defined(HAVE_LIBPTHREAD)</font>
00197 <font class="preprocessor"></font>        <font class="keywordtype">int</font> threadId = pthread_self();
00198 <font class="preprocessor">#endif</font>
00199 <font class="preprocessor"></font>        SBWOSMutexLock ml(threadStoreMutex);
00200         std::map&lt;int, SBWException *&gt;::iterator itr = exceptionMap.find(threadId);
00201 
00202         <font class="keywordflow">if</font> (itr == exceptionMap.end())
00203                 <font class="keywordflow">return</font> NULL ;
00204         <font class="keywordflow">else</font>
00205                 <font class="keywordflow">return</font> (*itr).second ;
00206 }
00207 
<a name="l00212"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#d5">00212</a> <font class="keywordtype">void</font> SBWException::clearStoredException()
00213 {
00214 <font class="preprocessor">#ifdef WIN32</font>
00215 <font class="preprocessor"></font>        DWORD threadId = GetCurrentThreadId();
00216 <font class="preprocessor">#elif defined(HAVE_LIBPTHREAD)</font>
00217 <font class="preprocessor"></font>        <font class="keywordtype">int</font> threadId = pthread_self();
00218 <font class="preprocessor">#endif</font>
00219 <font class="preprocessor"></font>        SBWOSMutexLock ml(threadStoreMutex);
00220         <a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a0">SBWException</a> *exception = SBWException::getStoredException();
00221 
00222         <font class="keyword">delete</font> exception ;
00223         exceptionMap.erase(threadId);
00224 }
00225 
<a name="l00229"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a11">00229</a> <font class="keywordtype">void</font> SBWException::storeException()
00230 {
00231 <font class="preprocessor">#ifdef WIN32</font>
00232 <font class="preprocessor"></font>        DWORD threadId = GetCurrentThreadId();
00233 <font class="preprocessor">#elif defined(HAVE_LIBPTHREAD)</font>
00234 <font class="preprocessor"></font>        <font class="keywordtype">int</font> threadId = pthread_self();
00235 <font class="preprocessor">#endif</font>
00236 <font class="preprocessor"></font>        SBWOSMutexLock ml(threadStoreMutex);
00237         <a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a0">SBWException</a> *exception = SBWException::getStoredException();
00238 
00239         <font class="keyword">delete</font> exception ;
00240         exceptionMap[threadId] = <font class="keyword">this</font> ;
00241 }
00242 
<a name="l00248"></a><a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#d6">00248</a> <font class="keywordtype">void</font> SBWException::throwStoredException()
00249 {
00250 <font class="preprocessor">#ifdef WIN32</font>
00251 <font class="preprocessor"></font>        DWORD threadId = GetCurrentThreadId();
00252 <font class="preprocessor">#elif defined(HAVE_LIBPTHREAD)</font>
00253 <font class="preprocessor"></font>        <font class="keywordtype">int</font> threadId = pthread_self();
00254 <font class="preprocessor">#endif</font>
00255 <font class="preprocessor"></font>        SBWOSMutexLock ml(threadStoreMutex);
00256         <a class="code" href="classSystemsBiologyWorkbench_1_1SBWException.html#a0">SBWException</a> *exception = SBWException::getStoredException();
00257 
00258         exceptionMap.erase(threadId);
00259 
00260         <font class="keywordflow">throw</font> exception ;
00261 }
</pre></div><hr>
<br>
<address>
<center>
<b>Systems Biology Workbench Development Group</b><br>
ERATO Kitano Systems Biology Project<br>
Control and Dynamical Systems, MC 107-81<br>
California Institute of Technology, Pasadena, CA 91125, USA<br>
<A HREF="mailto:sysbio-team@caltech.edu">sysbio-team@caltech.edu</A><br>
<A HREF="http://www.cds.caltech.edu/erato">http://www.cds.caltech.edu/erato</A><br><br>
<small>
Generated on Fri Nov 22 00:10:05 2002 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.2.14
</small>
</center>
</address>
</body>
</html>
